<!DOCTYPE html>
<html lang="fr">
  <head>  
    <meta charset="UTF-8">
    <title>Mon Espace Ksos</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <header class="top-bar">
      <h1>üë§ Mon Espace Ksos</h1>
      <a href="index.html">‚Üê Retour √† l‚Äôaccueil</a>

      <div id="auth-bar">
        <input type="email" id="email" placeholder="Email">
        <input type="password" id="password" placeholder="Mot de passe">
        <button id="login">Se connecter</button>
        <button id="logout" style="display:none;">Se d√©connecter</button>
        <button id="go-to-signup">Cr√©er un compte</button>
        <div id="user-info"></div>
      </div>
    </header>
    <main>
      <p>Du contenu pour les membres √† venir...</p>
    </main>

    <footer>
      <p>¬© Ksos - Tous droits r√©serv√©s</p>
    </footer>
    
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
      import {
        getAuth,
        onAuthStateChanged,
        signInWithEmailAndPassword,
        createUserWithEmailAndPassword,
        signOut
      } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";

      const firebaseConfig = {
        apiKey: "AIzaSyAimK0CJsMXb1EqBtfqB36hrEunO4Ybk3c",
        authDomain: "bibliothequekassossiale.firebaseapp.com",
        projectId: "bibliothequekassossiale",
        storageBucket: "bibliothequekassossiale.firebasestorage.app",
        messagingSenderId: "1029476191647",
        appId: "1:1029476191647:web:4da50f87d9aacc635b81aa",
        measurementId: "G-83CKLXJJHD"
      };

      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);

      const emailInput = document.getElementById("email");
      const passwordInput = document.getElementById("password");
      const signupBtn = document.getElementById("signup");
      const loginBtn = document.getElementById("login");
      const logoutBtn = document.getElementById("logout");
      const userInfo = document.getElementById("user-info");
      const goToSignup = document.getElementById("go-to-signup");

      if (goToSignup) {
        goToSignup.addEventListener("click", () => {
          window.location.href = "inscription.html";
        });
      }

      if (signupBtn && loginBtn && logoutBtn && emailInput && passwordInput) {
        signupBtn.addEventListener("click", () => {
          createUserWithEmailAndPassword(auth, emailInput.value, passwordInput.value)
            .then(() => alert("‚úÖ Compte cr√©√© !"))
            .catch(error => alert("‚ùå " + error.message));
        });

        loginBtn.addEventListener("click", () => {
          signInWithEmailAndPassword(auth, emailInput.value, passwordInput.value)
            .then(() => alert("‚úÖ Connect√© !"))
            .catch(error => alert("‚ùå " + error.message));
        });

        logoutBtn.addEventListener("click", () => {
          signOut(auth)
            .then(() => {
              alert("‚úÖ D√©connect√© !");
              location.reload();
            })
            .catch(error => alert("‚ùå Erreur : " + error.message));
        });
      }

      onAuthStateChanged(auth, (user) => {
        if (user) {
          logoutBtn.style.display = "inline-block";
          signupBtn.style.display = "none";
          loginBtn.style.display = "none";
          userInfo.innerHTML = `<p>Connect√© en tant que <strong>${user.email}</strong></p>`;
        } else {
          logoutBtn.style.display = "none";
          signupBtn.style.display = "inline-block";
          loginBtn.style.display = "inline-block";
          userInfo.innerHTML = "<p>Tu n'es pas connect√©.</p>";
        }
      });
    </script>
    <script>
      document.body.insertAdjacentHTML("beforeend", "<p style='color:green;'>‚úÖ Script inline ex√©cut√©</p>");
    </script>
    <script type="module" src="auth.js"></script>
  </body>
</html>
